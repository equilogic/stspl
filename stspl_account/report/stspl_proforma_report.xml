<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
      <!-- Template for Header and Footer -->
      <template id="external_layout_stspl_account_proforma_invoice">
        <!-- Multicompany -->
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id"></t>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"></t>
        </t>
    
        <t t-call="stspl_account.external_layout_header_stspl_proforma_invoice" />
        <t t-raw="0" />
        <t t-call="stspl_account.external_layout_footer_stspl_proforma_invoice" />
      </template>
      
      <!-- Report Header -->
      <template id="external_layout_header_stspl_proforma_invoice">
        <div class="header">
          <div class="col-xs-3">
            <span t-if="o.company_id">
             <img t-att-src="'data:image/png;base64,%s' % o.company_id.logo" style="max-height: 65px;"/>
           </span>
          </div>
          <div class="col-xs-8 col-xs-offset-1 text-right">
            <div t-if="o.company_id" style="font-size:12px">
              <div>
                <h5><b><span t-field="o.company_id.name" ></span></b></h5>
              </div>

              <div>
                <span >Company Rrgistration No.</span>
                <span>:</span>
                <span t-field="o.company_id.company_registry"/>
              </div>

              <div>
                <span class="text-center">GST Rrgistration No.</span>
                <span>:</span>
                <t t-if="o.company_id.gst_no"><span t-field="o.company_id.gst_no"/></t>
              </div>

              <div>
                <span t-field="o.company_id.street"/>
              </div>
              <div>
                <span t-field="o.company_id.city"/>
              </div>
              <div>
                <span t-field="o.company_id.country_id"/>
                <span t-field="o.company_id.zip"/>
              </div>
                
              <div>
                <span>Tel :</span>
                <span t-field="o.company_id.phone"/>
                
                <span>Fax :</span>
                <span t-field="o.company_id.fax"/>
              </div>
            </div>
          </div>
          <div class="text-center">
            <h3><b>PROFORMA INVOICE</b></h3>
          </div> 
        </div>
      </template>

      <!-- Report Footer -->
      <template id="external_layout_footer_stspl_proforma_invoice">
        <div class="footer">
          <div class="last-page">
            <div class="row">
              <div class="col-xs-4 pull-right" style="font-size:11.5px">
                <table class="table table-condensed">
                  <tr>
                    <td>Sub-Total</td>
                    <td class="text-right">
                      <span class="text-left" t-field="o.currency_id.symbol" />
                      <span class="text-left" t-field="o.amount_untaxed" />
                    </td>
                  </tr>
                  <tr>
                    <td>GST</td>
                    <td class="text-right">
                      <span class="text-left" t-field="o.currency_id.symbol" />
                      <span t-field="o.amount_tax" />
                    </td>
                  </tr>
                  <tr>
                    <td><b>Total Due</b></td>
                    <td class="text-right">
                      <span class="text-left" t-field="o.currency_id.symbol" />
                      <span t-field="o.amount_total" />
                    </td>
                  </tr>
                </table>
              </div>
            </div>

            <table width="100%" style="border:1px solid;">
              <tr >
                <td class="text-center" width="25%">
                  <span>Consignee</span>
                </td>

                <td class="text-center" style="font-size:11px" width="45%">
                  <span>NO. OF PACKAGES:</span><br/>
                  <span>DIMENSIONS:</span><br/>
                  <span>TTL GROSS WT:</span>
                </td>

                <td width="20%"></td>
              </tr>
              <br/>
              <tr>
                <td class="text-left" width="25%">
                  <span>------------------------------------</span>
                  <span style="font-size:11px">Date/Signature/Company Stamp</span>
                </td>

                <td></td>

                <td class="text-center" width="20%">
                  <span>------------------------------</span>
                  <span style="font-size:11px">Authorised Signature</span>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </template>

      <template id="report.minimal_layout">
              <t t-raw="'&lt;base href=%s&gt;' % base_url"/>
              &lt;!DOCTYPE html&gt;
                  <html style="height: 0;">
                      <head>
                          <link href="/report/static/src/css/reset.min.css" rel="stylesheet"/>
                          <link href="/web/static/lib/bootstrap/css/bootstrap.css" rel="stylesheet"/>
                          <link href="/website/static/src/css/website.css" rel="stylesheet"/>
                          <link href="/web/static/lib/fontawesome/css/font-awesome.css" rel="stylesheet"/>
                          <style type='text/css'><t t-raw="css"/></style>
                          <t t-if="subst is True">
                                          <script>
                         function subst() {
                             var vars = {};
                             var x = document.location.search.substring(1).split('&amp;');
                             for (var i in x) {
                                 var z = x[i].split('=', 2);
                                 vars[z[0]] = unescape(z[1]);
                             }
                             var x=['frompage', 'topage', 'page', 'webpage', 'section', 'subsection', 'subsubsection'];
                             for (var i in x) {
                                 var y = document.getElementsByClassName(x[i]);
                                 for (var j=0; j&lt;y.length; ++j)
                                     y[j].textContent = vars[x[i]];
                             }
                             var operations = {
                    'last-page': function (elt) { elt.style.visibility = (vars.page === vars.topage) ? "visible" : "hidden"; },
                };

                             for (var klass in operations) {
                                 var y = document.getElementsByClassName(klass);
                                 for (var j=0; j&lt;y.length; ++j)
                                 operations[klass](y[j]);
                             }
                        }
                    </script>
                          </t>
                      </head>
                      <body class="container" onload="subst()">
                          <t t-raw="body"/>
                      </body>
                  </html>
            </template>

      
      <!-- Reports Template Main -->
      <template id="stspl_account_proforma_invoice_template">
        <style type="text/css"> 
            td.line , span.line ,th.line {
                font-family:times new roman;
            }
        </style>
        <t t-call="report.html_container">
          <t t-call="stspl_account.external_layout_stspl_account_proforma_invoice">
            <div class="page">
              <div class="oe_structure" />
              <div class="row">
                <table width="100%">
                  <tr>
                    <td width="2.5%"></td>
                    <td width="45%">
                     <span>Date:</span>
                     <span t-field="o.date_order" t-field-options='{"format": "dd-MM-Y"}' />
                    </td>
                    <td width="7.5%"></td>
                    <td width="45%">
                      <span>No.:</span>
                      <strong><span t-field="o.name"/></strong>
                    </td>
                  </tr>
                </table>
              </div>
              <table  width="100%" style="font-size:12px" >
                <tr>
                  <th width="50%" style="padding:5px">SOLD TO:</th>
                  <th width="55%" style="padding:5px">SHIP TO:</th>
                </tr>
                <tr class="table" style="border:0.5px solid" >
                  <td width="55%" style="border-right:0.5px solid;padding:10px">
                    <div t-if="o.partner_id" name="partner_header">
                      <div>
                        <span t-field="o.partner_id.name"/>
                      </div>
                      <div>
                        <span t-field="o.partner_id.house_no"/> 
                        <t t-if="o.partner_id.house_no">,</t>
                        <span t-field="o.partner_id.street"/>
                      </div>
                      <div>
                         <span t-field="o.partner_id.level_no"/> 
                        <t t-if="o.partner_id.level_no">,</t>
                        <span t-field="o.partner_id.street2"/>
                      </div>
                      <div>
                        <span t-field="o.partner_id.city"/>
                        <t t-if="o.partner_id.city">,</t>
                        <span t-field="o.partner_id.state_id"/>
                      </div>
                      <div>
                        <span t-field="o.partner_id.country_id"/>
                        <t t-if="o.partner_id.country_id">,</t>
                        <span t-field="o.partner_id.zip"/>
                      </div>
                    </div>
                    <br/>
                    <p>ATTN: <span t-field="o.attn_sales"/></p>
                  </td>

                  <td width="55%" style="padding:10px">
                    <div t-if="o.partner_id" name="partner_header">
                      <div>
                        <span t-field="o.partner_id.name"/>
                      </div>
                      <div>
                        <span t-field="o.partner_id.house_no"/>
                        <t t-if="o.partner_id.house_no">,</t>
                        <span t-field="o.partner_id.street"/>
                      </div>
                      <div>
                        <span t-field="o.partner_id.level_no"/>
                        <t t-if="o.partner_id.level_no">,</t>
                        <span t-field="o.partner_id.street2"/>
                      </div>
                      <div>
                        <span t-field="o.partner_id.city"/>
                        <t t-if="o.partner_id.city">,</t>
                        <span t-field="o.partner_id.state_id"/>
                      </div>
                      <div>
                        <span t-field="o.partner_id.country_id"/>
                         <t t-if="o.partner_id.country_id">,</t>
                        <span t-field="o.partner_id.zip"/>
                      </div>
                    </div>
                    <br/>                      
                    <p>ATTN: <span t-field="o.partner_id.parent_id"/></p>
                  </td>
                </tr>
              </table>
              <br/>

              <table style="border:0.5px solid;font-size:11px" width="100%">
                <tr style="border:0.5px solid">
                  <td style="border:0.5px solid;padding:5px"><strong>Payment Term</strong></td>
                  <td style="border:0.5px solid;padding:5px"><strong>Shipping Term</strong></td>
                  <td style="border:0.5px solid;padding:5px"><strong>RMA No.</strong></td>
                  <td style="border:0.5px solid;padding:5px"><strong>P/O No.</strong></td>
                  <td style="border:0.5px solid;padding:5px"><strong>Ship Via</strong></td>
                </tr>

                <tr style="border:0.5px solid">
                  <td style="border:0.5px solid;padding:5px"><span t-field="o.payment_term" /></td>
                  <td style="border:0.5px solid;padding:5px"><span t-field="o.payment_term" /></td>
                  <td style="border:0.5px solid;padding:5px"><span t-field="o.payment_term" /></td>
                  <td style="border:0.5px solid;padding:5px"><span t-field="o.name" /></td>
                  <td style="border:0.5px solid;padding:5px"><span/><span t-field="o.ship_via_id.name" /></td>
                </tr>
              </table>
              <br/>
              <table class="table table-condensed" style="border-top:0.5px solid;font-size:11px" width="100%">
                <thead>
                 <tr>
                    <th class="text-left line" width="10%">Item No.</th>
                    <th class="text-center line" width="30%">Description/Part No</th>
                    <th class="text-left line" width="15%">Qty</th>
                    <th class="text-left line" width="15%">Unit</th>
                    <th class="text-left line" width="15%">Unit Price</th>
                    <th class="text-left line" width="15%">Amount:SGD</th>
                 </tr>
                </thead>
                <tbody>
                  <tr t-foreach="o.order_line" t-as="line">
                    <td width="10%">
                      <span t-esc="line_index+1"/>
                    </td>
                    <td width="30%">
                      <span t-field="line.name"/>
                    </td>
                    <td width="15%">
                      <span t-field="line.product_uom_qty" t-field-options='{"widget": "int"}' />
                    </td>
                    <td width="15%">
                      <span t-field="line.product_uom.name"/> 
                    </td>
                    <td width="15%">
                      <span t-field="o.currency_id.symbol" />
                      <span t-field="line.price_unit"/>
                    </td>
                    <td width="15%">
                      <span t-field="o.currency_id.symbol" />
                      <span t-field="line.price_subtotal"/>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </t>
        </t>
      </template>
        
      <template id="report_stspl_proforma_invoice">
        <t t-call="report.html_container">
            <t t-foreach="doc_ids" t-as="doc_id">
                <t t-raw="translate_doc(doc_id, doc_model, 'partner_id.lang', 'stspl_account.stspl_account_proforma_invoice_template')"/>
            </t>
        </t>
      </template>
    </data>
</openerp>
